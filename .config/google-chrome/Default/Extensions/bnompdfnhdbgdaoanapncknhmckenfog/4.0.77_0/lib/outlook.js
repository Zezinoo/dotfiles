!function(){function u(t,e){function i(t,e){return e<(t=parseInt(t,10).toString(16)).length?t.slice(t.length-e):e>t.length?Array(e-t.length+1).join("0")+t:t}return void 0===t&&(t=""),this.php_js||(this.php_js={}),this.php_js.uniqidSeed||(this.php_js.uniqidSeed=Math.floor(123456789*Math.random())),this.php_js.uniqidSeed++,t=t,t=(t+=i(parseInt((new Date).getTime()/1e3,10),8))+i(this.php_js.uniqidSeed,5),e&&(t+=(10*Math.random()).toFixed(8).toString()),t}window.emailtracker_detector=u();var c=window.emailtracker_detector,t=XMLHttpRequest.prototype,i=t.open,l=t.send;t.open=function(t,e){return this._url=e,i.apply(this,arguments)},t.send=function(e){if(window.emailtracker_detector!==c)return l.apply(this,arguments);this.addEventListener("load",function(){var t;~this._url.indexOf("action=CreateItem")||~this._url.indexOf("action=UpdateItem")&&e?"SendAndSaveCopy"===(t=JSON.parse(e)).Body.MessageDisposition&&top.document.dispatchEvent(new CustomEvent("emailtracker_sent",{detail:{post:t,response:this.responseText}})):(~this._url.indexOf("FindItem")||~this._url.indexOf("FindConversation"))&&document.dispatchEvent(new CustomEvent("emailtracker_items",{detail:{body:this.responseText}}))});try{var t,n,a,o;return top.document.documentElement.getAttribute("data-emailtracker-initialized")&&(~this._url.indexOf("action=CreateItem")||~this._url.indexOf("action=UpdateItem"))&&e&&"SendAndSaveCopy"===(t=JSON.parse(e)).Body.MessageDisposition?(n=this,a=arguments,o="emailtracker_send"+u(),top.document.dispatchEvent(new CustomEvent("emailtracker_send",{detail:{sid:o,post:t}})),r=function(){return top[o]},s=function(){var i;-1!==top[o]&&(t.Body.Items?t.Body.Items[0].Body.Value=top[o]:(i=t.Body.ItemChanges[0].Updates).forEach(function(t,e){t.Item&&t.Item.Body&&(i[e].Item.Body.Value=top[o])}),a[0]=JSON.stringify(t)),l.apply(n,a)},(d=(d={retries:10,callback_timeout:function(){l.apply(n,a)}})||{}).delay=d.delay||500,d.retries=d.retries||30,p=0,i(),!0):l.apply(this,arguments)}catch(t){return l.apply(this,arguments)}function i(){p++,r()?s():p<=d.retries?setTimeout(i,d.delay):d.callback_timeout&&d.callback_timeout()}var r,s,d,p}}();
