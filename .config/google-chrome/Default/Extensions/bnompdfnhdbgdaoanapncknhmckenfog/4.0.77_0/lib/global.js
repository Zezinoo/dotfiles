function Request_background(t,e,n){var a,r;window.BACKGROUND?Xtion_request(t,e,n):(r=null,(n=n||{}).error&&(a=n.error.bind(),r=function(t){t&&"object"==typeof t&&"error"===t.a?a(t.e):e(t)},n.error=1),chrome.runtime.sendMessage({a:"request",url:t,options:n},r||e))}function Cookie_get(t){t=("; "+document.cookie).split("; "+t+"=");if(2<=t.length)return t[1].split(";").shift()}function Background_cookie(t,e,n){n=n||{},chrome.runtime.sendMessage({a:"cookie",details:{url:n.url||LOCATION_MAIN,name:t}},e)}function Background_cookie_set(t,e,n,a,r){r=r||{},chrome.runtime.sendMessage({a:"cookie_set",details:{url:r.url||LOCATION_MAIN,name:t,value:e,expirationDate:n}},a||function(){})}function Script_inject(t){var e=document.createElement("script");e.src=t,(document.head||document.documentElement).appendChild(e)}function Script_embed(t){var e=document.createElement("script");e.textContent="(function(){"+t+"})()",(document.head||document.documentElement).appendChild(e)}function Variable(t,e){var n=Uniqid("",!0);Variable_custom(n,'document.dispatchEvent(new CustomEvent("variable'+n+'",{detail:'+(~t.indexOf("(")?t:~t.indexOf(".")?"window."+t:'window["'+t+'"]')+"}))",e)}function Variable_custom(e,t,n){function a(t){document.removeEventListener("variable"+e,a),r.parentNode.removeChild(r),n(t.detail)}document.addEventListener("variable"+e,a);var r=document.createElement("script");r.textContent="(function(){"+t+"})()",(document.head||document.documentElement).appendChild(r)}function Storage_get(e,n){chrome.storage.local.get(e,function(t){n(e instanceof Array?t:t[e])})}function Storage_update(t,e,n){var a={};a[t]=e,chrome.storage.local.set(a,n||function(){})}function Css_rule(e,n,a){var r=setInterval(function(){var t=(a||document).styleSheets[0];t&&(t.insertRule(e,n||0),clearInterval(r))},1e3)}function Interval_retry(e,n,a){(a=a||{}).delay=a.delay||500,a.retries=a.retries||30;function r(){i++;var t=e();t?n(t):i<=a.retries?setTimeout(r,a.delay):a.callback_timeout&&a.callback_timeout()}var i=0;r()}function Email_valid(t){return/[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?/i.test(t)}function Error_popup(t,e,n,a,r){r=r||{},t&&(Xtion_popup_temporary("Email Tracker Error #"+t+": Try refreshing the page. Mail clients may change things that can break the extension. Please contact us for help at info@emailtracker.website. (Version: "+chrome.runtime.getManifest().version+")"+(e?" Details: "+Xtion_html_special_chars(e+""):"")+(DEBUG&&n?" (Internal: "+Xtion_html_special_chars(n)+")":""),{time:15e3,container_click:function(){Xtion_popup_close(this)}}),a||Error_report(t,e+(n?" (Internal: "+n+")":""),"",!0,r))}function Error_report(e,n,a,t,r){r=r||{},!DEBUG||r.debug_report?Storage_get("error_rate_limit",function(t){(!(t=t||{})[e]||t[e].count<3||6048e5<(new Date).getTime()-t[e].last)&&(t[e]?t[e].count=3<=t[e].count?1:t[e].count+1:t[e]={count:1},t[e].last=(new Date).getTime(),Storage_update("error_rate_limit",t),t=window.error_report_custom,r.custom&&(t=Xtion_object_merge(t,r.custom)),Xtion_request("https://api.rollbar.com/api/1/item/",null,{post:JSON.stringify({access_token:"7f46dfc3601e4d1da82c8c126090fc8d",data:{environment:chrome.runtime.getManifest().version,level:"error",platform:"client",language:"javascript",body:{message:{body:e+(n?": "+n:"")+(a?" (Internal: "+a+")":"")}},request:{url:window.location.href,user_ip:"$remote_ip"},client:{javascript:{browser:navigator.userAgent}},custom:t}})}))}):t||Error_popup(e,n,a,!0),DEBUG&&console.error(e,n,a)}function Uniqid(t,e){void 0===t&&(t="");function n(t,e){return e<(t=parseInt(t,10).toString(16)).length?t.slice(t.length-e):e>t.length?Array(e-t.length+1).join("0")+t:t}return this.php_js||(this.php_js={}),this.php_js.uniqidSeed||(this.php_js.uniqidSeed=Math.floor(123456789*Math.random())),this.php_js.uniqidSeed++,t=t,t=(t+=n(parseInt((new Date).getTime()/1e3,10),8))+n(this.php_js.uniqidSeed,5),e&&(t+=(10*Math.random()).toFixed(8).toString()),t}function Background_storage_set(t,e,n){chrome.runtime.sendMessage({a:"background_storage_set",key:t,value:e},n||function(){})}function Moment_date_pretty(t){window.moment_date_pretty_timezone_guess=window.moment_date_pretty_timezone_guess||window.moment.tz.guess();t=t.tz(window.moment_date_pretty_timezone_guess);return t.fromNow().replace("a few ","")+" "+t.calendar(null,{sameDay:moment.localeData().calendar("sameDay").replace(" LT"," LTS"),nextDay:moment.localeData().calendar("nextDay").replace(" LT"," LTS"),nextWeek:moment.localeData().calendar("nextWeek").replace(" LT"," LTS"),lastDay:moment.localeData().calendar("lastDay").replace(" LT"," LTS"),lastWeek:moment.localeData().calendar("lastWeek").replace(" LT"," LTS"),sameElse:moment.localeData().longDateFormat("LLLL").replace(" LT"," LTS").replace(" h:mm"," h:mm:ss")}).replace("Today","today").replace("Yesterday","yesterday").replace("Last","last")}function User_is_pro(e,t,n){t&&window.USER_PRO?e(window.USER_PRO):window[window.CONTENT?"Request_background":"Xtion_request"](LOCATION_ACTION+"user_pro",function(t){window.USER_PRO=1==t,Storage_update("user_pro",t),e(1==t)},n?{loading_overlay:1}:{})}function __(t){return chrome.i18n.getMessage(t)}window.LOCATION_MAIN="https://emailtracker.website/",window.LOCATION_ACTION=window.LOCATION_MAIN+"a/",window.LOCATION_STATIC=window.LOCATION_MAIN+"static/",window.DEBUG=0,window.BACKGROUND=0,window.TESTING=0,window.PUSH_GCM_ID="171732813728",window.LOCATION_TRACKERS=[LOCATION_ACTION,"https://my-email-signature.link/"],window.LOCATION_TRACKERS_V=[LOCATION_TRACKERS[0]+"email_view.gif",LOCATION_TRACKERS[1]+"signature.gif"],window.LOCATION_TRACKER_V=LOCATION_TRACKERS_V[1],window.error_report_custom={};var countries_iso={A1:"Anonymous Proxy",A2:"Satellite Provider",O1:"Other Country",AD:"Andorra",AE:"United Arab Emirates",AF:"Afghanistan",AG:"Antigua and Barbuda",AI:"Anguilla",AL:"Albania",AM:"Armenia",AO:"Angola",AP:"Asia/Pacific Region",AQ:"Antarctica",AR:"Argentina",AS:"American Samoa",AT:"Austria",AU:"Australia",AW:"Aruba",AX:"Aland Islands",AZ:"Azerbaijan",BA:"Bosnia and Herzegovina",BB:"Barbados",BD:"Bangladesh",BE:"Belgium",BF:"Burkina Faso",BG:"Bulgaria",BH:"Bahrain",BI:"Burundi",BJ:"Benin",BL:"Saint Barthelemy",BM:"Bermuda",BN:"Brunei Darussalam",BO:"Bolivia",BQ:"Bonaire': Saint Eustatius and Saba",BR:"Brazil",BS:"Bahamas",BT:"Bhutan",BV:"Bouvet Island",BW:"Botswana",BY:"Belarus",BZ:"Belize",CA:"Canada",CC:"Cocos (Keeling) Islands",CD:"Congo': The Democratic Republic of the",CF:"Central African Republic",CG:"Congo",CH:"Switzerland",CI:"Cote d'Ivoire",CK:"Cook Islands",CL:"Chile",CM:"Cameroon",CN:"China",CO:"Colombia",CR:"Costa Rica",CU:"Cuba",CV:"Cape Verde",CW:"Curacao",CX:"Christmas Island",CY:"Cyprus",CZ:"Czech Republic",DE:"Germany",DJ:"Djibouti",DK:"Denmark",DM:"Dominica",DO:"Dominican Republic",DZ:"Algeria",EC:"Ecuador",EE:"Estonia",EG:"Egypt",EH:"Western Sahara",ER:"Eritrea",ES:"Spain",ET:"Ethiopia",EU:"Europe",FI:"Finland",FJ:"Fiji",FK:"Falkland Islands (Malvinas)",FM:"Micronesia': Federated States of",FO:"Faroe Islands",FR:"France",GA:"Gabon",GB:"United Kingdom",GD:"Grenada",GE:"Georgia",GF:"French Guiana",GG:"Guernsey",GH:"Ghana",GI:"Gibraltar",GL:"Greenland",GM:"Gambia",GN:"Guinea",GP:"Guadeloupe",GQ:"Equatorial Guinea",GR:"Greece",GS:"South Georgia and the South Sandwich Islands",GT:"Guatemala",GU:"Guam",GW:"Guinea-Bissau",GY:"Guyana",HK:"Hong Kong",HM:"Heard Island and McDonald Islands",HN:"Honduras",HR:"Croatia",HT:"Haiti",HU:"Hungary",ID:"Indonesia",IE:"Ireland",IL:"Israel",IM:"Isle of Man",IN:"India",IO:"British Indian Ocean Territory",IQ:"Iraq",IR:"Iran': Islamic Republic of",IS:"Iceland",IT:"Italy",JE:"Jersey",JM:"Jamaica",JO:"Jordan",JP:"Japan",KE:"Kenya",KG:"Kyrgyzstan",KH:"Cambodia",KI:"Kiribati",KM:"Comoros",KN:"Saint Kitts and Nevis",KP:"Korea': Democratic People's Republic of",KR:"Korea': Republic of",KW:"Kuwait",KY:"Cayman Islands",KZ:"Kazakhstan",LA:"Lao People's Democratic Republic",LB:"Lebanon",LC:"Saint Lucia",LI:"Liechtenstein",LK:"Sri Lanka",LR:"Liberia",LS:"Lesotho",LT:"Lithuania",LU:"Luxembourg",LV:"Latvia",LY:"Libyan Arab Jamahiriya",MA:"Morocco",MC:"Monaco",MD:"Moldova': Republic of",ME:"Montenegro",MF:"Saint Martin",MG:"Madagascar",MH:"Marshall Islands",MK:"Macedonia",ML:"Mali",MM:"Myanmar",MN:"Mongolia",MO:"Macao",MP:"Northern Mariana Islands",MQ:"Martinique",MR:"Mauritania",MS:"Montserrat",MT:"Malta",MU:"Mauritius",MV:"Maldives",MW:"Malawi",MX:"Mexico",MY:"Malaysia",MZ:"Mozambique",NA:"Namibia",NC:"New Caledonia",NE:"Niger",NF:"Norfolk Island",NG:"Nigeria",NI:"Nicaragua",NL:"Netherlands",NO:"Norway",NP:"Nepal",NR:"Nauru",NU:"Niue",NZ:"New Zealand",OM:"Oman",PA:"Panama",PE:"Peru",PF:"French Polynesia",PG:"Papua New Guinea",PH:"Philippines",PK:"Pakistan",PL:"Poland",PM:"Saint Pierre and Miquelon",PN:"Pitcairn",PR:"Puerto Rico",PS:"Palestinian Territory",PT:"Portugal",PW:"Palau",PY:"Paraguay",QA:"Qatar",RE:"Reunion",RO:"Romania",RS:"Serbia",RU:"Russian Federation",RW:"Rwanda",SA:"Saudi Arabia",SB:"Solomon Islands",SC:"Seychelles",SD:"Sudan",SE:"Sweden",SG:"Singapore",SH:"Saint Helena",SI:"Slovenia",SJ:"Svalbard and Jan Mayen",SK:"Slovakia",SL:"Sierra Leone",SM:"San Marino",SN:"Senegal",SO:"Somalia",SR:"Suriname",SS:"South Sudan",ST:"Sao Tome and Principe",SV:"El Salvador",SX:"Sint Maarten",SY:"Syrian Arab Republic",SZ:"Swaziland",TC:"Turks and Caicos Islands",TD:"Chad",TF:"French Southern Territories",TG:"Togo",TH:"Thailand",TJ:"Tajikistan",TK:"Tokelau",TL:"Timor-Leste",TM:"Turkmenistan",TN:"Tunisia",TO:"Tonga",TR:"Turkey",TT:"Trinidad and Tobago",TV:"Tuvalu",TW:"Taiwan",TZ:"Tanzania': United Republic of",UA:"Ukraine",UG:"Uganda",UM:"United States Minor Outlying Islands",US:"United States",UY:"Uruguay",UZ:"Uzbekistan",VA:"Holy See (Vatican City State)",VC:"Saint Vincent and the Grenadines",VE:"Venezuela",VG:"Virgin Islands': British",VI:"Virgin Islands': U.S.",VN:"Vietnam",VU:"Vanuatu",WF:"Wallis and Futuna",WS:"Samoa",YE:"Yemen",YT:"Mayotte",ZA:"South Africa",ZM:"Zambia",ZW:"Zimbabwe"};function React_input_set_value(t,e){var n=t.value,e=(t.value=e,new Event("input",{target:t,bubbles:!0})),a=(e.simulated=!0,t._valueTracker);a&&a.setValue(n),t.dispatchEvent(e)}function Tracker_parse_email_views(t,s){s=s||{};var c="";return t.forEach(function(t){var e,n="<td>"+Moment_date_pretty(window.moment.unix(t.timestamp))+"</td>",a=s.ip_website?~s.ip_website.indexOf("{ip}")?s.ip_website.replace("{ip}",t.ip):s.ip_website+t.ip:"http://whatismyipaddress.com/ip/"+t.ip,a=" ("+(t.proxy?'<a href="'+LOCATION_MAIN+'proxy" target="_blank">Proxy</a>':'<a href="'+a+'" target="_blank">Info</a>')+")",r=t.link||"",i=t.proxy?"":"image/icon/"+(0<t.type?1==t.type?"phone":"tablet":"desktop")+".png",o=(t.proxy||!t.device_agent||t.device_agent_preview||(t.device_agent_preview="Other Device"),"");!t.proxy&&t.country&&(e=Xtion_html_special_chars("Country "+countries_iso[t.country]||t.country),o='<img src="'+LOCATION_STATIC+"global/framework/flag-icons/flags/4x3/"+Xtion_html_special_chars(t.country).toLowerCase()+'.svg" width="16" height="12" width="" title="'+e+'" alt="'+e+'"/>'),c+="<tr><td><span>"+t.ip+"</span> "+(o?o+" ":"")+"<span>"+a+"</span> "+(i?'<img src="'+(window.CONTENT?chrome.extension.getURL(i):i)+'" alt="Device Type" title="Viewed on a '+(0<t.type?1==t.type?"Phone":"Tablet":"Computer")+'"/>':"")+(t.device_agent_preview?' <a href="'+LOCATION_MAIN+"a/device_agent_information?agent="+encodeURIComponent(t.device_agent)+'" title="Click For More Info On Device: '+Xtion_html_special_chars(t.device_agent)+'" target="_blank">'+t.device_agent_preview+"</a>":"")+(r?(t.device_agent_preview?"<br/>":"")+'<a href="'+r+'" title="'+r+'" target="_blank" class="link"><img src="'+(window.CONTENT?chrome.extension.getURL("image/icon/link.png"):"image/icon/link.png")+'" alt="Tracked Link Clicked" title="Tracked Link Clicked"/> '+r+"</a>":"")+"&nbsp;&nbsp; </td>"+n+"</tr>"}),"<table><tbody>"+c+"</tbody></table>"}function Tracker_email_link_corrections(t){return t?~t.indexOf("outlook.live.com/mail/deeplink")?t.replace("/deeplink","/0/deeplink"):t:""}function Tracker_email_link(t,e,n){if(t)switch(t=t.split("_",2),parseInt(t[0])){case 1:return"https://mail.google.com/mail/u/?"+(e?"authuser="+encodeURIComponent(e):"")+(~t[1].indexOf("msg-")?"#search/permmsgid%3A"+t[1]:"#sent/"+t[1]);case 2:return"https://outlook.live.com/owa/?viewmodel=ReadMessageItem&ispopout=1&ItemID="+encodeURIComponent(t[1])+(n?"&emailtracker_id="+encodeURIComponent(n):"");case 3:return"https://mail.yahoo.com/neo/b/message?mid="+encodeURIComponent(t[1]);case 4:return"https://inbox.google.com/sent?"+(e?"authuser="+encodeURIComponent(e):"")+"&th="+encodeURIComponent(t[1])}return""}function Tracker_warning(n,a){Storage_get("warning_"+n,function(t){var e;t||((t=document.createElement("div")).innerHTML="<h1>Email Tracker Warning</h1>"+a+"<br/><br/>",(e=document.createElement("button")).textContent="Do Not Show Again",e.onclick=function(){Storage_update("warning_"+n,1),Xtion_popup_close()},t.appendChild(e),(e=document.createElement("button")).textContent="Close",e.style.cssText="margin-left:8px;",e.onclick=function(){Xtion_popup_close()},t.appendChild(e),Xtion_popup(t,{overlay_close:0}))})}function Element_textnodes(t){for(var e,n=[],a=document.createTreeWalker(t,NodeFilter.SHOW_TEXT,null,!1);e=a.nextNode();)n.push(e);return n}function setIntervalTimeout(t,e,n){var a=setInterval(t,e);return setTimeout(function(){clearInterval(a)},n),a}function Object_property(e,t){try{return t.forEach(function(t){e=e[t]}),e}catch(t){return null}}function Object_search(t,e,o,s){var c=0,l=0;(s=s||{}).compare_json&&(e=JSON.stringify(e));try{!function t(r,e,i){Xtion_foreach(r,function(n,a){if(l++,s.limit&&l===s.limit)throw{};if(s.compare_json&&e==JSON.stringify(n)){if(c=o?i:r,!s.last)throw{}}else if("object"==typeof n)t(n,e,r);else if("object"==typeof e)Xtion_foreach(e,function(t,e){if(a==e&&(n==t||s.value_contains&&n.indexOf&&~n.indexOf(t)))if(s.contains_keys)Xtion_foreach(r,function(t,e){Xtion_foreach(s.contains_keys,function(t){if(e===t&&(s.also&&!s.also(o?i:r)||(c=o?i:r),!s.last))throw{}})});else if(s.also&&!s.also(o?i:r)||(c=o?i:r),!s.last)throw{}});else if(n==e||s.value_contains&&n.indexOf&&~n.indexOf(e))if(s.contains_keys)Xtion_foreach(r,function(t,e){Xtion_foreach(s.contains_keys,function(t){if(e===t&&(s.also&&!s.also(o?i:r)||(c=o?i:r),!s.last))throw{}})});else if(s.also&&!s.also(o?i:r)||(c=o?i:r),!s.last)throw{}})}(t,e)}catch(t){0!==Object.keys(t).length&&console.error(t)}return c}function add(t,e,n){for(var a=[],r=Math.max(t.length,e.length),i=0,o=0;o<r||i;){var s=i+(o<t.length?t[o]:0)+(o<e.length?e[o]:0);a.push(s%n),i=Math.floor(s/n),o++}return a}function multiplyByNumber(t,e,n){if(t<0)return null;if(0==t)return[];for(var a=[],r=e;1&t&&(a=add(a,r,n)),0!=(t>>=1);)r=add(r,r,n);return a}function parseToDigitsArray(t,e){for(var n=t.split(""),a=[],r=n.length-1;0<=r;r--){var i=parseInt(n[r],e);if(isNaN(i))return null;a.push(i)}return a}function convertBase(t,e,n){var a=parseToDigitsArray(t,e);if(null===a)return null;for(var r=[],i=[1],o=0;o<a.length;o++)a[o]&&(r=add(r,multiplyByNumber(a[o],i,n),n)),i=multiplyByNumber(e,i,n);for(var s="",o=r.length-1;0<=o;o--)s+=r[o].toString(n);return s}function decToHex(t){t=convertBase(t,10,16);return t||null}function hexToDec(t){return convertBase(t=t.toLowerCase(),16,10)}!function(t,e){"function"==typeof define&&define.amd?define([],function(){return t.Autolinker=e()}):"object"==typeof exports?module.exports=e():t.Autolinker=e()}(this,function(){function b(t){if(b.Util.assign(this,t),!1!==(t=this.hashtag)&&"twitter"!==t&&"facebook"!==t&&"instagram"!==t)throw new Error("invalid `hashtag` cfg - see docs");this.urls=this.normalizeUrlsCfg(this.urls),this.truncate=this.normalizeTruncateCfg(this.truncate)}var t,e;return b.prototype={constructor:b,urls:!0,email:!0,twitter:!0,phone:!0,hashtag:!1,newWindow:!0,stripPrefix:!0,truncate:void 0,className:"",htmlParser:void 0,matchParser:void 0,tagBuilder:void 0,normalizeUrlsCfg:function(t){return"boolean"==typeof t?{schemeMatches:t,wwwMatches:t,tldMatches:t}:b.Util.defaults(t||{},{schemeMatches:!0,wwwMatches:!0,tldMatches:!0})},normalizeTruncateCfg:function(t){return"number"==typeof t?{length:t,location:"end"}:b.Util.defaults(t||{},{length:Number.POSITIVE_INFINITY,location:"end"})},link:function(t){if(!t)return"";for(var e=this.getHtmlParser().parse(t),n=0,a=[],r=0,i=e.length;r<i;r++){var o=e[r],s=o.getType(),c=o.getText();"element"===s?("a"===o.getTagName()&&(o.isClosing()?n=Math.max(n-1,0):n++),a.push(c)):"entity"!==s&&"comment"!==s&&0===n?(o=this.linkifyStr(c),a.push(o)):a.push(c)}return a.join("")},linkifyStr:function(t){return this.getMatchParser().replace(t,this.createMatchReturnVal,this)},createMatchReturnVal:function(t){var e;return"string"==typeof(e=this.replaceFn?this.replaceFn.call(this,this,t):e)?e:!1===e?t.getMatchedText():(e instanceof b.HtmlTag?e:this.getTagBuilder().build(t)).toAnchorString()},getHtmlParser:function(){return this.htmlParser||(this.htmlParser=new b.htmlParser.HtmlParser)},getMatchParser:function(){return this.matchParser||(this.matchParser=new b.matchParser.MatchParser({urls:this.urls,email:this.email,twitter:this.twitter,phone:this.phone,hashtag:this.hashtag,stripPrefix:this.stripPrefix}))},getTagBuilder:function(){return this.tagBuilder||(this.tagBuilder=new b.AnchorTagBuilder({newWindow:this.newWindow,truncate:this.truncate,className:this.className}))}},b.link=function(t,e){return new b(e).link(t)},b.match={},b.htmlParser={},b.matchParser={},b.truncate={},b.HtmlTag=(b.Util={abstractMethod:function(){throw"abstract"},trimRegex:/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,assign:function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t},defaults:function(t,e){for(var n in e)e.hasOwnProperty(n)&&void 0===t[n]&&(t[n]=e[n]);return t},extend:function(t,e){function n(){}var a=t.prototype,r=(n.prototype=a,(t=e.hasOwnProperty("constructor")?e.constructor:function(){a.constructor.apply(this,arguments)}).prototype=new n);return r.constructor=t,r.superclass=a,delete e.constructor,b.Util.assign(r,e),t},ellipsis:function(t,e,n){return t=t.length>e?t.substring(0,e-(n=null==n?"..":n).length)+n:t},indexOf:function(t,e){if(Array.prototype.indexOf)return t.indexOf(e);for(var n=0,a=t.length;n<a;n++)if(t[n]===e)return n;return-1},splitAndCapture:function(t,e){if(!e.global)throw new Error("`splitRegex` must have the 'g' flag set");for(var n,a=[],r=0;n=e.exec(t);)a.push(t.substring(r,n.index)),a.push(n[0]),r=n.index+n[0].length;return a.push(t.substring(r)),a},trim:function(t){return t.replace(this.trimRegex,"")}}).extend(Object,{whitespaceRegex:/\s+/,constructor:function(t){b.Util.assign(this,t),this.innerHtml=this.innerHtml||this.innerHTML},setTagName:function(t){return this.tagName=t,this},getTagName:function(){return this.tagName||""},setAttr:function(t,e){return this.getAttrs()[t]=e,this},getAttr:function(t){return this.getAttrs()[t]},setAttrs:function(t){var e=this.getAttrs();return b.Util.assign(e,t),this},getAttrs:function(){return this.attrs||(this.attrs={})},setClass:function(t){return this.setAttr("class",t)},addClass:function(t){for(var e,n=this.getClass(),a=this.whitespaceRegex,r=b.Util.indexOf,i=n?n.split(a):[],o=t.split(a);e=o.shift();)-1===r(i,e)&&i.push(e);return this.getAttrs().class=i.join(" "),this},removeClass:function(t){for(var e,n=this.getClass(),a=this.whitespaceRegex,r=b.Util.indexOf,i=n?n.split(a):[],o=t.split(a);i.length&&(e=o.shift());){var s=r(i,e);-1!==s&&i.splice(s,1)}return this.getAttrs().class=i.join(" "),this},getClass:function(){return this.getAttrs().class||""},hasClass:function(t){return-1!==(" "+this.getClass()+" ").indexOf(" "+t+" ")},setInnerHtml:function(t){return this.innerHtml=t,this},getInnerHtml:function(){return this.innerHtml||""},toAnchorString:function(){var t=this.getTagName(),e=this.buildAttrsStr();return["<",t,e=e?" "+e:"",">",this.getInnerHtml(),"</",t,">"].join("")},buildAttrsStr:function(){if(!this.attrs)return"";var t,e=this.getAttrs(),n=[];for(t in e)e.hasOwnProperty(t)&&n.push(t+'="'+e[t]+'"');return n.join(" ")}}),b.AnchorTagBuilder=b.Util.extend(Object,{constructor:function(t){b.Util.assign(this,t)},build:function(t){return new b.HtmlTag({tagName:"a",attrs:this.createAttrs(t.getType(),t.getAnchorHref()),innerHtml:this.processAnchorText(t.getAnchorText())})},createAttrs:function(t,e){e={href:e},t=this.createCssClass(t);return t&&(e.class=t),this.newWindow&&(e.target="_blank"),e},createCssClass:function(t){var e=this.className;return e?e+" "+e+"-"+t:""},processAnchorText:function(t){return this.doTruncate(t)},doTruncate:function(t){var e,n=this.truncate;return n?(e=n.length,"smart"===(n=n.location)?b.truncate.TruncateSmart(t,e,".."):"middle"===n?b.truncate.TruncateMiddle(t,e,".."):b.truncate.TruncateEnd(t,e,"..")):t}}),b.htmlParser.HtmlParser=b.Util.extend(Object,{htmlRegex:(e=/[^\s\0"'>\/=\x01-\x1F\x7F]+/.source+"(?:\\s*=\\s*"+(t=/(?:"[^"]*?"|'[^']*?'|[^'"=<>`\s]+)/).source+")?",new RegExp(["(?:","<(!DOCTYPE)","(?:","\\s+","(?:",e,"|",t.source+")",")*",">",")","|","(?:","<(/)?","(?:",/!--([\s\S]+?)--/.source,"|","(?:","("+/[0-9a-zA-Z][0-9a-zA-Z:]*/.source+")","(?:","\\s+",e,")*","\\s*/?",")",")",">",")"].join(""),"gi")),htmlCharacterEntitiesRegex:/(&nbsp;|&#160;|&lt;|&#60;|&gt;|&#62;|&quot;|&#34;|&#39;)/gi,parse:function(t){for(var e,n,a,r=this.htmlRegex,i=0,o=[];null!==(e=r.exec(t));){var s=e[0],c=e[3],l=e[1]||e[4],u=!!e[2],h=t.substring(i,e.index);h&&(n=this.parseTextAndEntityNodes(h),o.push.apply(o,n)),o.push(c?this.createCommentNode(s,c):this.createElementNode(s,l,u)),i=e.index+s.length}return i<t.length&&(a=t.substring(i))&&(n=this.parseTextAndEntityNodes(a),o.push.apply(o,n)),o},parseTextAndEntityNodes:function(t){for(var e=[],n=b.Util.splitAndCapture(t,this.htmlCharacterEntitiesRegex),a=0,r=n.length;a<r;a+=2){var i=n[a],o=n[a+1];i&&e.push(this.createTextNode(i)),o&&e.push(this.createEntityNode(o))}return e},createCommentNode:function(t,e){return new b.htmlParser.CommentNode({text:t,comment:b.Util.trim(e)})},createElementNode:function(t,e,n){return new b.htmlParser.ElementNode({text:t,tagName:e.toLowerCase(),closing:n})},createEntityNode:function(t){return new b.htmlParser.EntityNode({text:t})},createTextNode:function(t){return new b.htmlParser.TextNode({text:t})}}),b.htmlParser.HtmlNode=b.Util.extend(Object,{text:"",constructor:function(t){b.Util.assign(this,t)},getType:b.Util.abstractMethod,getText:function(){return this.text}}),b.htmlParser.CommentNode=b.Util.extend(b.htmlParser.HtmlNode,{comment:"",getType:function(){return"comment"},getComment:function(){return this.comment}}),b.htmlParser.ElementNode=b.Util.extend(b.htmlParser.HtmlNode,{tagName:"",closing:!1,getType:function(){return"element"},getTagName:function(){return this.tagName},isClosing:function(){return this.closing}}),b.htmlParser.EntityNode=b.Util.extend(b.htmlParser.HtmlNode,{getType:function(){return"entity"}}),b.htmlParser.TextNode=b.Util.extend(b.htmlParser.HtmlNode,{getType:function(){return"text"}}),b.matchParser.MatchParser=b.Util.extend(Object,{urls:!0,email:!0,twitter:!0,phone:!0,hashtag:!1,stripPrefix:!0,matcherRegex:(t=/[A-Za-z0-9\.\-]*[A-Za-z0-9\-]/,e=/\.(?:international|construction|contractors|enterprises|photography|productions|foundation|immobilien|industries|management|properties|technology|christmas|community|directory|education|equipment|institute|marketing|solutions|vacations|bargains|boutique|builders|catering|cleaning|clothing|computer|democrat|diamonds|graphics|holdings|lighting|partners|plumbing|supplies|training|ventures|academy|careers|company|cruises|domains|exposed|flights|florist|gallery|guitars|holiday|kitchen|neustar|okinawa|recipes|rentals|reviews|shiksha|singles|support|systems|agency|berlin|camera|center|coffee|condos|dating|estate|events|expert|futbol|kaufen|luxury|maison|monash|museum|nagoya|photos|repair|report|social|supply|tattoo|tienda|travel|viajes|villas|vision|voting|voyage|actor|build|cards|cheap|codes|dance|email|glass|house|mango|ninja|parts|photo|press|shoes|solar|today|tokyo|tools|watch|works|aero|arpa|asia|best|bike|blue|buzz|camp|club|cool|coop|farm|fish|gift|guru|info|jobs|kiwi|kred|land|limo|link|menu|mobi|moda|name|pics|pink|post|qpon|rich|ruhr|sexy|tips|vote|voto|wang|wien|wiki|zone|bar|bid|biz|cab|cat|ceo|com|edu|gov|int|kim|mil|net|onl|org|pro|pub|red|tel|uno|wed|xxx|xyz|ac|ad|ae|af|ag|ai|al|am|an|ao|aq|ar|as|at|au|aw|ax|az|ba|bb|bd|be|bf|bg|bh|bi|bj|bm|bn|bo|br|bs|bt|bv|bw|by|bz|ca|cc|cd|cf|cg|ch|ci|ck|cl|cm|cn|co|cr|cu|cv|cw|cx|cy|cz|de|dj|dk|dm|do|dz|ec|ee|eg|er|es|et|eu|fi|fj|fk|fm|fo|fr|ga|gb|gd|ge|gf|gg|gh|gi|gl|gm|gn|gp|gq|gr|gs|gt|gu|gw|gy|hk|hm|hn|hr|ht|hu|id|ie|il|im|in|io|iq|ir|is|it|je|jm|jo|jp|ke|kg|kh|ki|km|kn|kp|kr|kw|ky|kz|la|lb|lc|li|lk|lr|ls|lt|lu|lv|ly|ma|mc|md|me|mg|mh|mk|ml|mm|mn|mo|mp|mq|mr|ms|mt|mu|mv|mw|mx|my|mz|na|nc|ne|nf|ng|ni|nl|no|np|nr|nu|nz|om|pa|pe|pf|pg|ph|pk|pl|pm|pn|pr|ps|pt|pw|py|qa|re|ro|rs|ru|rw|sa|sb|sc|sd|se|sg|sh|si|sj|sk|sl|sm|sn|so|sr|st|su|sv|sx|sy|sz|tc|td|tf|tg|th|tj|tk|tl|tm|tn|to|tp|tr|tt|tv|tw|tz|ua|ug|uk|us|uy|uz|va|vc|ve|vg|vi|vn|vu|wf|ws|ye|yt|za|zm|zw)\b/,new RegExp(["(",/(^|[^\w])@(\w{1,15})/.source,")","|","(",/(?:[\-;:&=\+\$,\w\.]+@)/.source,t.source,e.source,")","|","(","(?:","(",/(?:[A-Za-z][-.+A-Za-z0-9]*:(?![A-Za-z][-.+A-Za-z0-9]*:\/\/)(?!\d+\/?)(?:\/\/)?)/.source,t.source,")","|","(","(.?//)?",/(?:www\.)/.source,t.source,")","|","(","(.?//)?",t.source,e.source,")",")","(?:"+/[\-A-Za-z0-9+&@#\/%=~_()|'$*\[\]?!:,.;]*[\-A-Za-z0-9+&@#\/%=~_()|'$*\[\]]/.source+")?",")","|","(",/(?:(\+)?\d{1,3}[-\040.])?\(?\d{3}\)?[-\040.]?\d{3}[-\040.]\d{4}/.source,")","|","(",/(^|[^\w])#(\w{1,139})/.source,")"].join(""),"gi")),charBeforeProtocolRelMatchRegex:/^(.)?\/\//,constructor:function(t){b.Util.assign(this,t),this.matchValidator=new b.MatchValidator},replace:function(t,a,r){var i=this;return t.replace(this.matcherRegex,function(t){var e,n=i.processCandidateMatch.apply(i,arguments);return n?(e=a.call(r,n.match),n.prefixStr+e+n.suffixStr):t})},processCandidateMatch:function(t,e,n,a,r,i,o,s,c,l,u,h,m,d,g,p){var c=c||u,u="",f="",w=this.urls;return o&&!w.schemeMatches||s&&!w.wwwMatches||l&&!w.tldMatches||r&&!this.email||h&&!this.phone||e&&!this.twitter||d&&!this.hashtag||!this.matchValidator.isValidMatch(i,o,c)?null:(this.matchHasUnbalancedClosingParen(t)?(t=t.substr(0,t.length-1),f=")"):-1<(s=this.matchHasInvalidCharAfterTld(i,o))&&(f=t.substr(s),t=t.substr(0,s)),i=r?new b.match.Email({matchedText:t,email:r}):e?(n&&(u=n,t=t.slice(1)),new b.match.Twitter({matchedText:t,twitterHandle:a})):h?(l=t.replace(/\D/g,""),new b.match.Phone({matchedText:t,number:l,plusSign:!!m})):d?(g&&(u=g,t=t.slice(1)),new b.match.Hashtag({matchedText:t,serviceName:this.hashtag,hashtag:p})):(c&&(w=c.match(this.charBeforeProtocolRelMatchRegex)[1]||"")&&(u=w,t=t.slice(1)),new b.match.Url({matchedText:t,url:t,protocolUrlMatch:!!o,protocolRelativeMatch:!!c,stripPrefix:this.stripPrefix})),{prefixStr:u,suffixStr:f,match:i})},matchHasUnbalancedClosingParen:function(t){if(")"===t.charAt(t.length-1)){var e=t.match(/\(/g),t=t.match(/\)/g);if((e&&e.length||0)<(t&&t.length||0))return!0}return!1},matchHasInvalidCharAfterTld:function(t,e){var n;return t&&(n=0,e&&(n=t.indexOf(":"),t=t.slice(n)),null!==(e=/^((.?\/\/)?[A-Za-z0-9\.\-]*[A-Za-z0-9\-]\.[A-Za-z]+)/.exec(t)))&&(n+=e[1].length,t=t.slice(e[1].length),/^[^.A-Za-z:\/?#]/.test(t))?n:-1}}),b.MatchValidator=b.Util.extend(Object,{invalidProtocolRelMatchRegex:/^[\w]\/\//,hasFullProtocolRegex:/^[A-Za-z][-.+A-Za-z0-9]*:\/\//,uriSchemeRegex:/^[A-Za-z][-.+A-Za-z0-9]*:/,hasWordCharAfterProtocolRegex:/:[^\s]*?[A-Za-z]/,isValidMatch:function(t,e,n){return!(e&&!this.isValidUriScheme(e)||this.urlMatchDoesNotHaveProtocolOrDot(t,e)||this.urlMatchDoesNotHaveAtLeastOneWordChar(t,e)||this.isInvalidProtocolRelativeMatch(n))},isValidUriScheme:function(t){t=t.match(this.uriSchemeRegex)[0].toLowerCase();return"javascript:"!==t&&"vbscript:"!==t},urlMatchDoesNotHaveProtocolOrDot:function(t,e){return!(!t||e&&this.hasFullProtocolRegex.test(e)||-1!==t.indexOf("."))},urlMatchDoesNotHaveAtLeastOneWordChar:function(t,e){return!(!t||!e||this.hasWordCharAfterProtocolRegex.test(t))},isInvalidProtocolRelativeMatch:function(t){return!!t&&this.invalidProtocolRelMatchRegex.test(t)}}),b.match.Match=b.Util.extend(Object,{constructor:function(t){b.Util.assign(this,t)},getType:b.Util.abstractMethod,getMatchedText:function(){return this.matchedText},getAnchorHref:b.Util.abstractMethod,getAnchorText:b.Util.abstractMethod}),b.match.Email=b.Util.extend(b.match.Match,{getType:function(){return"email"},getEmail:function(){return this.email},getAnchorHref:function(){return"mailto:"+this.email},getAnchorText:function(){return this.email}}),b.match.Hashtag=b.Util.extend(b.match.Match,{getType:function(){return"hashtag"},getHashtag:function(){return this.hashtag},getAnchorHref:function(){var t=this.serviceName,e=this.hashtag;switch(t){case"twitter":return"https://twitter.com/hashtag/"+e;case"facebook":return"https://www.facebook.com/hashtag/"+e;case"instagram":return"https://instagram.com/explore/tags/"+e;default:throw new Error("Unknown service name to point hashtag to: ",t)}},getAnchorText:function(){return"#"+this.hashtag}}),b.match.Phone=b.Util.extend(b.match.Match,{getType:function(){return"phone"},getNumber:function(){return this.number},getAnchorHref:function(){return"tel:"+(this.plusSign?"+":"")+this.number},getAnchorText:function(){return this.matchedText}}),b.match.Twitter=b.Util.extend(b.match.Match,{getType:function(){return"twitter"},getTwitterHandle:function(){return this.twitterHandle},getAnchorHref:function(){return"https://twitter.com/"+this.twitterHandle},getAnchorText:function(){return"@"+this.twitterHandle}}),b.match.Url=b.Util.extend(b.match.Match,{urlPrefixRegex:/^(https?:\/\/)?(www\.)?/i,protocolRelativeRegex:/^\/\//,protocolPrepended:!1,getType:function(){return"url"},getUrl:function(){var t=this.url;return this.protocolRelativeMatch||this.protocolUrlMatch||this.protocolPrepended||(t=this.url="http://"+t,this.protocolPrepended=!0),t},getAnchorHref:function(){return this.getUrl().replace(/&amp;/g,"&")},getAnchorText:function(){var t=this.getMatchedText();return this.protocolRelativeMatch&&(t=this.stripProtocolRelativePrefix(t)),this.stripPrefix&&(t=this.stripUrlPrefix(t)),this.removeTrailingSlash(t)},stripUrlPrefix:function(t){return t.replace(this.urlPrefixRegex,"")},stripProtocolRelativePrefix:function(t){return t.replace(this.protocolRelativeRegex,"")},removeTrailingSlash:function(t){return t="/"===t.charAt(t.length-1)?t.slice(0,-1):t}}),b.truncate.TruncateEnd=function(t,e,n){return b.Util.ellipsis(t,e,n)},b.truncate.TruncateMiddle=function(t,e,n){var a,r;return t.length<=e?t:(r="",0<(a=e-n.length)&&(r=t.substr(-1*Math.floor(a/2))),(t.substr(0,Math.ceil(a/2))+n+r).substr(0,e))},b.truncate.TruncateSmart=function(t,e,r){function n(t){var e="";return t.scheme&&t.host&&(e+=t.scheme+"://"),t.host&&(e+=t.host),t.path&&(e+="/"+t.path),t.query&&(e+="?"+t.query),t.fragment&&(e+="#"+t.fragment),e}function a(t,e){var e=e/2,n=Math.ceil(e),e=-1*Math.floor(e),a="";return e<0&&(a=t.substr(e)),t.substr(0,n)+r+a}if(t.length<=e)return t;var i=e-r.length,o=(s={},(c=(o=t).match(/^([a-z]+):\/\//i))&&(s.scheme=c[1],o=o.substr(c[0].length)),(c=o.match(/^(.*?)(?=(\?|#|\/|$))/i))&&(s.host=c[1],o=o.substr(c[0].length)),(c=o.match(/^\/(.*?)(?=(\?|#|$))/i))&&(s.path=c[1],o=o.substr(c[0].length)),(c=o.match(/^\?(.*?)(?=(#|$))/i))&&(s.query=c[1],o=o.substr(c[0].length)),(c=o.match(/^#(.*?)$/i))&&(s.fragment=c[1]),s);if(o.query&&(c=o.query.match(/^(.*?)(?=(\?|\#))(.*?)$/i))&&(o.query=o.query.substr(0,c[1].length),t=n(o)),t.length<=e)return t;if(o.host&&(o.host=o.host.replace(/^www\./,""),t=n(o)),t.length<=e)return t;var s="";if(o.host&&(s+=o.host),s.length>=i)return(o.host.length==e?o.host.substr(0,e-r.length)+r:a(s,i)).substr(0,e);var c="";if(o.path&&(c+="/"+o.path),o.query&&(c+="?"+o.query),c){if(i<=(s+c).length)return((s+c).length==e?s+c:s+a(c,i-s.length)).substr(0,e);s+=c}if(o.fragment){var t="#"+o.fragment;if(i<=(s+t).length)return((s+t).length==e?s+t:s+a(t,i-s.length)).substr(0,e);s+=t}if(o.scheme&&o.host){c=o.scheme+"://";if((s+c).length<i)return(c+s).substr(0,e)}return s.length<=e?s:(t="",0<i&&(t=s.substr(-1*Math.floor(i/2))),(s.substr(0,Math.ceil(i/2))+r+t).substr(0,e))},b});
